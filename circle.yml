machine:

  services:
    - docker

  python:
    version: 3.6.3

general:
  branches:
    ignore:
      - gh-pages


dependencies:
  override:
    - pip install -r benchmarks/requirements/ci.txt
    - flake8
    - make build
    - ./benchmark.sh --info


test:
  override:
    - ./benchmark.sh -J results/benchmarks.json


deployment:
  registry:
    branch: master
    commands:
      - docker login -p $DOCKER_PASS -e $DOCKER_EMAIL -u $DOCKER_USER
      - make push
      - python -m benchmarks.upload results/benchmarks.json --path $BENCHMARK_PATH
